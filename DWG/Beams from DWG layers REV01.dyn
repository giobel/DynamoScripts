<Workspace Version="1.2.3.592" X="1804.17565323257" Y="836.518420970477" zoom="0.284982041396537" ScaleFactor="1" Name="Home" Description="" RunType="Manual" RunPeriod="1000" HasRunWithoutCrash="False">
  <NamespaceResolutionMap />
  <Elements>
    <Dynamo.Nodes.DSModelElementSelection guid="0509eed7-e5b9-43a9-aaf4-53d8da7ee443" type="Dynamo.Nodes.DSModelElementSelection" nickname="Select Model Element" x="-4210.99057598166" y="-887.898581036016" isVisible="true" isUpstreamVisible="true" lacing="Disabled" isSelectedInput="True" IsFrozen="false" isPinned="false" />
    <Dynamo.Graph.Nodes.ZeroTouch.DSFunction guid="1c522a25-6af4-46aa-b350-60727ce727a5" type="Dynamo.Graph.Nodes.ZeroTouch.DSFunction" nickname="StructuralFraming.BeamByCurve" x="-2497.71586016833" y="-939.917909722104" isVisible="true" isUpstreamVisible="true" lacing="Longest" isSelectedInput="False" IsFrozen="false" isPinned="false" assembly="RevitNodes.dll" function="Revit.Elements.StructuralFraming.BeamByCurve@Autodesk.DesignScript.Geometry.Curve,Revit.Elements.Level,Revit.Elements.FamilyType">
      <PortInfo index="0" default="False" />
      <PortInfo index="1" default="False" />
      <PortInfo index="2" default="False" />
    </Dynamo.Graph.Nodes.ZeroTouch.DSFunction>
    <CoreNodeModels.Input.BoolSelector guid="789a48f6-aa1d-42e8-b96e-4e1887c6125d" type="CoreNodeModels.Input.BoolSelector" nickname="Boolean" x="-3484.27648977074" y="-643.760513531554" isVisible="true" isUpstreamVisible="true" lacing="Disabled" isSelectedInput="True" IsFrozen="false" isPinned="false">
      <System.Boolean>False</System.Boolean>
    </CoreNodeModels.Input.BoolSelector>
    <PythonNodeModels.PythonNode guid="82ae8341-4028-4330-91cf-58a2361cd83b" type="PythonNodeModels.PythonNode" nickname="Python Script" x="-3207.06297781119" y="-837.740234877733" isVisible="true" isUpstreamVisible="true" lacing="Disabled" isSelectedInput="False" IsFrozen="false" isPinned="false" inputcount="4">
      <PortInfo index="0" default="False" />
      <PortInfo index="1" default="False" />
      <PortInfo index="2" default="False" />
      <PortInfo index="3" default="False" />
      <Script>#Copyright 2016. All rights reserved. Bimorph Consultancy LTD, 5 St Johns Lane, London EC1M 4BH www.bimorph.co.uk
#Written by Thomas Mahon @Thomas__Mahon info@bimorph.co.uk package: bimorphNodes
#GitHub: https://github.com/ThomasMahon/bimorphNodes/

import clr

# Import DocumentManager and TransactionManager
clr.AddReference("RevitServices")
import RevitServices
from RevitServices.Persistence import DocumentManager
from RevitServices.Transactions import TransactionManager
from System.Collections.Generic import *

clr.AddReference("RevitNodes")
import Revit
# Import ToProtoType, ToRevitType geometry conversion extension methods
clr.ImportExtensions(Revit.GeometryConversion)

# Import RevitAPI
clr.AddReference("RevitAPI")
import Autodesk
from Autodesk.Revit.DB import *

doc = DocumentManager.Instance.CurrentDBDocument
uiapp = DocumentManager.Instance.CurrentUIApplication
app = uiapp.Application

importDWG = UnwrapElement(IN[0])
nameOfLayersToImport = IN[1]
revitModelLines = IN[2]

if nameOfLayersToImport == None or nameOfLayersToImport == []: 
	catSub = importDWG.Category.SubCategories
	enum = catSub.GetEnumerator()
	
	nameOfLayersToImport = []
	while enum.MoveNext():
		layerName = enum.Current.Name
		nameOfLayersToImport.Add( layerName )

if isinstance(nameOfLayersToImport, list):
	layerList = nameOfLayersToImport
else:
	layerList = [nameOfLayersToImport]

def storageDictionary(crvListDict, eleGraphicStyleName, e):
	if eleGraphicStyleName in crvListDict.keys(): 
		crvListDict[eleGraphicStyleName].append( e )
	else:
		crvListDict[eleGraphicStyleName] = []
		crvListDict[eleGraphicStyleName].append( e )
		
	
def curveConversion (crv, revitModelLines, crvObject, refPlane):
	if revitModelLines == True:
		crv.Add( doc.Create.NewModelCurve( crvObject, refPlane) )
	else:
		crv.Add( crvObject.ToProtoType() )
	
TransactionManager.Instance.EnsureInTransaction(doc)

geomEnum = importDWG.Geometry[ Options() ].GetEnumerator()

crvListDict = dict()
failedFilter = []
while geomEnum.MoveNext(): 
	instGeom = geomEnum.Current.GetInstanceGeometry()
	
	instGeomEnum = instGeom.GetEnumerator()
	while instGeomEnum.MoveNext():
		e = instGeomEnum.Current
		try:
			graphicStyleId = e.GraphicsStyleId
					
			eleGraphicStyle = doc.GetElement(graphicStyleId)
			eleGraphicStyleName = eleGraphicStyle.GraphicsStyleCategory.Name
			
			
			if eleGraphicStyleName in layerList: 
				storageDictionary(crvListDict, eleGraphicStyleName, e)

		except:
			try: 
				vol = e.Volume
				
				if vol == 0.0: 
					edgesList = e.Edges
					edgesEnum = edgesList.GetEnumerator()

					while edgesEnum.MoveNext():
						edge = edgesEnum.Current
						eleGraphicStyle = doc.GetElement(edge.GraphicsStyleId)
						eleGraphicStyleName = eleGraphicStyle.GraphicsStyleCategory.Name
						
						if eleGraphicStyleName in layerList:
							storageDictionary(crvListDict, eleGraphicStyleName, edge.AsCurve() )
							
			except: 
				failedFilter.Add(e)

if "2015" in app.VersionName:
	levelParam = "Base Level"
else:
	levelParam = BuiltInParameter.IMPORT_BASE_LEVEL

levelId = UnwrapElement(IN[3]).Id

pln = SketchPlane.Create(doc, levelId )
	
crvList = [ crv for crv in crvListDict.values() ] 

failedConversion = []
modelLines =  []
for subList in crvList: 
	crv = []
	for i in subList: 
		try:
			crvType = i.GetType()
			if crvType != Autodesk.Revit.DB.PolyLine:
				curveConversion(crv, revitModelLines, i, pln)
			else: 
				pt = i.GetCoordinates()
				count = i.NumberOfCoordinates
					
				for j in range(count-1): 
					ln = Line.CreateBound(pt[j], pt[j+1])
					curveConversion(crv, revitModelLines, ln, pln)
						
		except: 
			failedConversion.Add( i )
				
	modelLines.Add(crv)

TransactionManager.Instance.TransactionTaskDone()

OUT = modelLines, crvListDict.keys()</Script>
    </PythonNodeModels.PythonNode>
    <DSRevitNodesUI.Levels guid="7478bc31-c70e-4d79-ac7f-9a6d7c30c98f" type="DSRevitNodesUI.Levels" nickname="Levels" x="-4421.46286435879" y="-534.511811663343" isVisible="true" isUpstreamVisible="true" lacing="Disabled" isSelectedInput="True" IsFrozen="false" isPinned="false" index="0:00" />
    <Dynamo.Graph.Nodes.CodeBlockNodeModel guid="8a2817fd-301b-40ab-9d2e-f35a92bbfb85" type="Dynamo.Graph.Nodes.CodeBlockNodeModel" nickname="Code Block" x="-2790.98451316386" y="-949.462553035722" isVisible="true" isUpstreamVisible="true" lacing="Disabled" isSelectedInput="False" IsFrozen="false" isPinned="false" CodeText="Flatten(a[0]);" ShouldFocus="false">
      <PortInfo index="0" default="False" />
    </Dynamo.Graph.Nodes.CodeBlockNodeModel>
    <PythonNodeModels.PythonNode guid="18de7573-ca20-46ca-8b51-c6a2f4e3c68a" type="PythonNodeModels.PythonNode" nickname="Python Script" x="-3799.70687574549" y="-285.843735550175" isVisible="true" isUpstreamVisible="true" lacing="Disabled" isSelectedInput="False" IsFrozen="false" isPinned="false" inputcount="1">
      <PortInfo index="0" default="False" />
      <Script>import clr
clr.AddReference('ProtoGeometry')
from Autodesk.DesignScript.Geometry import *

# Import RevitAPI
clr.AddReference("RevitAPI")
import Autodesk
from Autodesk.Revit.DB import *

# Import RevitAPI
clr.AddReference("RevitServices")
import RevitServices
from RevitServices.Persistence import DocumentManager

#The inputs to this node will be stored as a list in the IN variables.
doc = DocumentManager.Instance.CurrentDBDocument
cat = doc.Settings.Categories

collector = FilteredElementCollector(doc).OfCategory(BuiltInCategory.OST_StructuralFraming)

#Assign your output to the OUT variable.
OUT = [i for i in collector]</Script>
    </PythonNodeModels.PythonNode>
    <Dynamo.Graph.Nodes.ZeroTouch.DSFunction guid="6d4e7ada-0520-4b82-94f5-1aa76132d53a" type="Dynamo.Graph.Nodes.ZeroTouch.DSFunction" nickname="String.Contains" x="-2917.85441287676" y="-206.072994889638" isVisible="true" isUpstreamVisible="true" lacing="Shortest" isSelectedInput="False" IsFrozen="false" isPinned="false" assembly="DSCoreNodes.dll" function="DSCore.String.Contains@string,string,bool">
      <PortInfo index="0" default="False" />
      <PortInfo index="1" default="False" />
      <PortInfo index="2" default="True" />
    </Dynamo.Graph.Nodes.ZeroTouch.DSFunction>
    <CoreNodeModels.Input.StringInput guid="33713f69-9823-4171-beb6-5861f0d8f442" type="CoreNodeModels.Input.StringInput" nickname="String" x="-4421.46286435879" y="-268.945782025638" isVisible="true" isUpstreamVisible="true" lacing="Disabled" isSelectedInput="True" IsFrozen="false" isPinned="false">
      <System.String>UKC203x203x71</System.String>
      <System.String value="UKC203x203x71" />
    </CoreNodeModels.Input.StringInput>
    <Dynamo.Graph.Nodes.CodeBlockNodeModel guid="ad82c5f5-5d85-495c-bf5b-6ebcb6d6e061" type="Dynamo.Graph.Nodes.CodeBlockNodeModel" nickname="Code Block" x="-3109.94450415997" y="-155.722307061807" isVisible="true" isUpstreamVisible="true" lacing="Disabled" isSelectedInput="False" IsFrozen="false" isPinned="false" CodeText="1;" ShouldFocus="false" />
    <Dynamo.Graph.Nodes.ZeroTouch.DSFunction guid="2055fd68-2ee3-491a-96d0-23d9a6e001d7" type="Dynamo.Graph.Nodes.ZeroTouch.DSFunction" nickname="Family.Name" x="-3556.95952888271" y="-236.330263270693" isVisible="true" isUpstreamVisible="true" lacing="Shortest" isSelectedInput="False" IsFrozen="false" isPinned="false" assembly="RevitNodes.dll" function="Revit.Elements.Family.Name">
      <PortInfo index="0" default="False" />
    </Dynamo.Graph.Nodes.ZeroTouch.DSFunction>
    <Dynamo.Graph.Nodes.ZeroTouch.DSFunction guid="8df92d03-7b04-4e9e-ba43-2a3b6663d227" type="Dynamo.Graph.Nodes.ZeroTouch.DSFunction" nickname="List.FilterByBoolMask" x="-2519.91965692173" y="-309.943012268576" isVisible="true" isUpstreamVisible="true" lacing="Shortest" isSelectedInput="False" IsFrozen="false" isPinned="false" assembly="DSCoreNodes.dll" function="DSCore.List.FilterByBoolMask@var[]..[],var[]..[]">
      <PortInfo index="0" default="False" />
      <PortInfo index="1" default="False" />
    </Dynamo.Graph.Nodes.ZeroTouch.DSFunction>
    <Dynamo.Graph.Nodes.CustomNodes.Function guid="e9a48d91-ace3-4dbf-b8bf-25d393245e76" type="Dynamo.Graph.Nodes.CustomNodes.Function" nickname="bv Remove Nulls" x="-3331.85639837908" y="-260.51367029996" isVisible="true" isUpstreamVisible="true" lacing="Shortest" isSelectedInput="False" IsFrozen="false" isPinned="false">
      <PortInfo index="0" default="False" />
      <ID value="a8b0f382-e8bc-4198-93af-a93c1afcf265" />
      <Name value="bv Remove Nulls" />
      <Description value="forked from Lunchbox" />
      <Inputs>
        <Input value="List" />
      </Inputs>
      <Outputs>
        <Output value="Cleaned" />
      </Outputs>
    </Dynamo.Graph.Nodes.CustomNodes.Function>
    <Dynamo.Graph.Nodes.ZeroTouch.DSFunction guid="6a380aca-da6f-437d-82fc-158ac34ba5e6" type="Dynamo.Graph.Nodes.ZeroTouch.DSFunction" nickname="StructuralFraming.ColumnByCurve" x="-3204.92916894731" y="342.596247155946" isVisible="true" isUpstreamVisible="true" lacing="Shortest" isSelectedInput="False" IsFrozen="false" isPinned="false" assembly="RevitNodes.dll" function="Revit.Elements.StructuralFraming.ColumnByCurve@Autodesk.DesignScript.Geometry.Curve,Revit.Elements.Level,Revit.Elements.FamilyType">
      <PortInfo index="0" default="False" />
      <PortInfo index="1" default="False" />
      <PortInfo index="2" default="False" />
    </Dynamo.Graph.Nodes.ZeroTouch.DSFunction>
    <Dynamo.Graph.Nodes.CodeBlockNodeModel guid="fac5a40a-77b2-4de4-af8c-7a082d6891c2" type="Dynamo.Graph.Nodes.CodeBlockNodeModel" nickname="Code Block" x="-4421.46286435879" y="201.537915917766" isVisible="true" isUpstreamVisible="true" lacing="Disabled" isSelectedInput="False" IsFrozen="false" isPinned="false" CodeText="a[8];" ShouldFocus="false">
      <PortInfo index="0" default="False" />
    </Dynamo.Graph.Nodes.CodeBlockNodeModel>
    <DSRevitNodesUI.Levels guid="d20b35ce-6759-44bf-8ade-c2623522ae44" type="DSRevitNodesUI.Levels" nickname="Levels" x="-4421.46286435879" y="481.963685581195" isVisible="true" isUpstreamVisible="true" lacing="Disabled" isSelectedInput="True" IsFrozen="false" isPinned="false" index="-1" />
    <DSRevitNodesUI.StructuralColumnTypes guid="72b61969-6842-4421-a30d-1ca0678bde5f" type="DSRevitNodesUI.StructuralColumnTypes" nickname="Structural Column Types" x="-4421.46286435879" y="780.903697277015" isVisible="true" isUpstreamVisible="true" lacing="Disabled" isSelectedInput="True" IsFrozen="false" isPinned="false" index="-1" />
    <PythonNodeModels.PythonNode guid="c880adb7-3613-4b3b-92a9-67177d6133e8" type="PythonNodeModels.PythonNode" nickname="Python Script" x="-3840.99860893941" y="168.347841322525" isVisible="true" isUpstreamVisible="true" lacing="Disabled" isSelectedInput="False" IsFrozen="false" isPinned="false" inputcount="4">
      <PortInfo index="0" default="False" />
      <PortInfo index="1" default="False" />
      <PortInfo index="2" default="False" />
      <PortInfo index="3" default="False" />
      <Script>#Copyright 2016. All rights reserved. Bimorph Consultancy LTD, 5 St Johns Lane, London EC1M 4BH www.bimorph.co.uk
#Written by Thomas Mahon @Thomas__Mahon info@bimorph.co.uk package: bimorphNodes
#GitHub: https://github.com/ThomasMahon/bimorphNodes/

import clr

# Import DocumentManager and TransactionManager
clr.AddReference("RevitServices")
import RevitServices
from RevitServices.Persistence import DocumentManager
from RevitServices.Transactions import TransactionManager
from System.Collections.Generic import *

clr.AddReference("RevitNodes")
import Revit
# Import ToProtoType, ToRevitType geometry conversion extension methods
clr.ImportExtensions(Revit.GeometryConversion)

# Import RevitAPI
clr.AddReference("RevitAPI")
import Autodesk
from Autodesk.Revit.DB import *

doc = DocumentManager.Instance.CurrentDBDocument
uiapp = DocumentManager.Instance.CurrentUIApplication
app = uiapp.Application

importDWG = UnwrapElement(IN[0])
nameOfLayersToImport = IN[1]
revitModelLines = IN[2]

if nameOfLayersToImport == None or nameOfLayersToImport == []: 
	catSub = importDWG.Category.SubCategories
	enum = catSub.GetEnumerator()
	
	nameOfLayersToImport = []
	while enum.MoveNext():
		layerName = enum.Current.Name
		nameOfLayersToImport.Add( layerName )

if isinstance(nameOfLayersToImport, list):
	layerList = nameOfLayersToImport
else:
	layerList = [nameOfLayersToImport]

def storageDictionary(crvListDict, eleGraphicStyleName, e):
	if eleGraphicStyleName in crvListDict.keys(): 
		crvListDict[eleGraphicStyleName].append( e )
	else:
		crvListDict[eleGraphicStyleName] = []
		crvListDict[eleGraphicStyleName].append( e )
		
	
def curveConversion (crv, revitModelLines, crvObject, refPlane):
	if revitModelLines == True:
		crv.Add( doc.Create.NewModelCurve( crvObject, refPlane) )
	else:
		crv.Add( crvObject.ToProtoType() )
	
TransactionManager.Instance.EnsureInTransaction(doc)

geomEnum = importDWG.Geometry[ Options() ].GetEnumerator()

crvListDict = dict()
failedFilter = []
while geomEnum.MoveNext(): 
	instGeom = geomEnum.Current.GetInstanceGeometry()
	
	instGeomEnum = instGeom.GetEnumerator()
	while instGeomEnum.MoveNext():
		e = instGeomEnum.Current
		try:
			graphicStyleId = e.GraphicsStyleId
					
			eleGraphicStyle = doc.GetElement(graphicStyleId)
			eleGraphicStyleName = eleGraphicStyle.GraphicsStyleCategory.Name
			
			
			if eleGraphicStyleName in layerList: 
				storageDictionary(crvListDict, eleGraphicStyleName, e)

		except:
			try: 
				vol = e.Volume
				
				if vol == 0.0: 
					edgesList = e.Edges
					edgesEnum = edgesList.GetEnumerator()

					while edgesEnum.MoveNext():
						edge = edgesEnum.Current
						eleGraphicStyle = doc.GetElement(edge.GraphicsStyleId)
						eleGraphicStyleName = eleGraphicStyle.GraphicsStyleCategory.Name
						
						if eleGraphicStyleName in layerList:
							storageDictionary(crvListDict, eleGraphicStyleName, edge.AsCurve() )
							
			except: 
				failedFilter.Add(e)

if "2015" in app.VersionName:
	levelParam = "Base Level"
else:
	levelParam = BuiltInParameter.IMPORT_BASE_LEVEL

levelId = UnwrapElement(IN[3]).Id

pln = SketchPlane.Create(doc, levelId )
	
crvList = [ crv for crv in crvListDict.values() ] 

failedConversion = []
modelLines =  []
for subList in crvList: 
	crv = []
	for i in subList: 
		try:
			crvType = i.GetType()
			if crvType != Autodesk.Revit.DB.PolyLine:
				curveConversion(crv, revitModelLines, i, pln)
			else: 
				pt = i.GetCoordinates()
				count = i.NumberOfCoordinates
					
				for j in range(count-1): 
					ln = Line.CreateBound(pt[j], pt[j+1])
					curveConversion(crv, revitModelLines, ln, pln)
						
		except: 
			failedConversion.Add( i )
				
	modelLines.Add(crv)

TransactionManager.Instance.TransactionTaskDone()

OUT = modelLines, crvListDict.keys()</Script>
    </PythonNodeModels.PythonNode>
    <CoreNodeModels.Input.BoolSelector guid="47ba6003-24aa-4123-a5a0-6e6c1afdea18" type="CoreNodeModels.Input.BoolSelector" nickname="Boolean" x="-4179.89904010067" y="313.941451317135" isVisible="true" isUpstreamVisible="true" lacing="Disabled" isSelectedInput="True" IsFrozen="false" isPinned="false">
      <System.Boolean>False</System.Boolean>
    </CoreNodeModels.Input.BoolSelector>
    <Dynamo.Graph.Nodes.CodeBlockNodeModel guid="55c8668b-cf50-4a8f-9193-863ac422c7b3" type="Dynamo.Graph.Nodes.CodeBlockNodeModel" nickname="Code Block" x="-3435.25330121625" y="306.718462452365" isVisible="true" isUpstreamVisible="true" lacing="Disabled" isSelectedInput="False" IsFrozen="false" isPinned="false" CodeText="Flatten(a[0]);" ShouldFocus="false">
      <PortInfo index="0" default="False" />
    </Dynamo.Graph.Nodes.CodeBlockNodeModel>
    <Dynamo.Graph.Nodes.ZeroTouch.DSFunction guid="403e05b7-f4f4-4207-8a31-f9af67ced0de" type="Dynamo.Graph.Nodes.ZeroTouch.DSFunction" nickname="Element.SetParameterByName" x="-1350.69252136094" y="-793.368320478794" isVisible="true" isUpstreamVisible="true" lacing="Shortest" isSelectedInput="False" IsFrozen="false" isPinned="false" assembly="RevitNodes.dll" function="Revit.Elements.Element.SetParameterByName@string,var">
      <PortInfo index="0" default="False" />
      <PortInfo index="1" default="False" />
      <PortInfo index="2" default="False" />
    </Dynamo.Graph.Nodes.ZeroTouch.DSFunction>
    <Dynamo.Graph.Nodes.CodeBlockNodeModel guid="ec19179a-c78b-42b2-b0f0-3f37a39b17ec" type="Dynamo.Graph.Nodes.CodeBlockNodeModel" nickname="Code Block" x="-1577.98647552545" y="-762.224766295511" isVisible="true" isUpstreamVisible="true" lacing="Disabled" isSelectedInput="False" IsFrozen="false" isPinned="false" CodeText="&quot;Comments&quot;;" ShouldFocus="false" />
    <Dynamo.Graph.Nodes.CodeBlockNodeModel guid="f85f7ade-73f2-4b05-b46c-a34b8b7155b0" type="Dynamo.Graph.Nodes.CodeBlockNodeModel" nickname="Code Block" x="-3589.00533113477" y="-778.507029622372" isVisible="true" isUpstreamVisible="true" lacing="Disabled" isSelectedInput="False" IsFrozen="false" isPinned="false" CodeText="{&quot;PURLINS&quot;};" ShouldFocus="false" />
    <Dynamo.Graph.Nodes.CodeBlockNodeModel guid="536f008a-5b32-41f9-9f5c-a9c2bc37b7b9" type="Dynamo.Graph.Nodes.CodeBlockNodeModel" nickname="Code Block" x="-2816.20067440811" y="-799.642117601175" isVisible="true" isUpstreamVisible="true" lacing="Disabled" isSelectedInput="False" IsFrozen="false" isPinned="false" CodeText="A[0];" ShouldFocus="false">
      <PortInfo index="0" default="False" />
    </Dynamo.Graph.Nodes.CodeBlockNodeModel>
    <Dynamo.Graph.Nodes.CodeBlockNodeModel guid="ddcd6f9f-6e25-40a4-b8aa-031cd1a49bbc" type="Dynamo.Graph.Nodes.CodeBlockNodeModel" nickname="Code Block" x="-2846.11908386215" y="-613.75927558848" isVisible="true" isUpstreamVisible="true" lacing="Disabled" isSelectedInput="False" IsFrozen="false" isPinned="false" CodeText="A[1];" ShouldFocus="false">
      <PortInfo index="0" default="False" />
    </Dynamo.Graph.Nodes.CodeBlockNodeModel>
    <CoreNodeModels.HigherOrder.Combine guid="c869b1e4-5c3c-4d8d-8a31-6ba8b1e9e916" type="CoreNodeModels.HigherOrder.Combine" nickname="List.Combine" x="-2143.15921943557" y="-822.092108225208" isVisible="true" isUpstreamVisible="true" lacing="Disabled" isSelectedInput="False" IsFrozen="false" isPinned="false" inputcount="4">
      <PortInfo index="0" default="False" />
      <PortInfo index="1" default="False" />
      <PortInfo index="2" default="False" />
      <PortInfo index="3" default="False" />
    </CoreNodeModels.HigherOrder.Combine>
    <Dynamo.Graph.Nodes.ZeroTouch.DSFunction guid="9b71543b-0a7f-4f0e-87cc-cf63a5134c9d" type="Dynamo.Graph.Nodes.ZeroTouch.DSFunction" nickname="List.Cycle" x="-1786.95589607802" y="-622.546909697486" isVisible="true" isUpstreamVisible="true" lacing="Longest" isSelectedInput="False" IsFrozen="false" isPinned="false" assembly="DSCoreNodes.dll" function="DSCore.List.Cycle@var[]..[],int">
      <PortInfo index="0" default="False" />
      <PortInfo index="1" default="False" />
    </Dynamo.Graph.Nodes.ZeroTouch.DSFunction>
    <Dynamo.Graph.Nodes.ZeroTouch.DSFunction guid="a2319839-617a-49ae-a885-879f136ba155" type="Dynamo.Graph.Nodes.ZeroTouch.DSFunction" nickname="Count" x="-1990.97792223543" y="-594.087532884142" isVisible="true" isUpstreamVisible="true" lacing="Longest" isSelectedInput="False" IsFrozen="false" isPinned="false" assembly="BuiltIn" function="Count@var[]..[]">
      <PortInfo index="0" default="False" />
    </Dynamo.Graph.Nodes.ZeroTouch.DSFunction>
    <Dynamo.Graph.Nodes.CodeBlockNodeModel guid="25d6fc9d-8286-4a39-b7d4-aa62647cc5f2" type="Dynamo.Graph.Nodes.CodeBlockNodeModel" nickname="Code Block" x="-1698.27352372139" y="-869.530137132859" isVisible="true" isUpstreamVisible="true" lacing="Disabled" isSelectedInput="False" IsFrozen="false" isPinned="false" CodeText="Flatten(a);" ShouldFocus="false">
      <PortInfo index="0" default="False" />
    </Dynamo.Graph.Nodes.CodeBlockNodeModel>
    <Dynamo.Graph.Nodes.CodeBlockNodeModel guid="b3a6a577-28e6-4a60-a58d-8d9f7cc28d0f" type="Dynamo.Graph.Nodes.CodeBlockNodeModel" nickname="Code Block" x="-1574.5197780998" y="-654.97243126064" isVisible="true" isUpstreamVisible="true" lacing="Disabled" isSelectedInput="False" IsFrozen="false" isPinned="false" CodeText="Flatten(a);" ShouldFocus="false">
      <PortInfo index="0" default="False" />
    </Dynamo.Graph.Nodes.CodeBlockNodeModel>
    <Dynamo.Nodes.DSModelElementSelection guid="c4325597-0277-4b48-bd8d-12f539a718bb" type="Dynamo.Nodes.DSModelElementSelection" nickname="Select Model Element" x="-3657.95745981254" y="-2338.05001393054" isVisible="true" isUpstreamVisible="true" lacing="Disabled" isSelectedInput="True" IsFrozen="false" isPinned="false" />
    <Dynamo.Graph.Nodes.CodeBlockNodeModel guid="d8e468a5-e110-44f9-b1ec-96cbb8d84961" type="Dynamo.Graph.Nodes.CodeBlockNodeModel" nickname="Code Block" x="-3865.69387236523" y="-2160.25121531875" isVisible="true" isUpstreamVisible="true" lacing="Disabled" isSelectedInput="False" IsFrozen="false" isPinned="false" CodeText="{&quot;PURLINS&quot;, &quot;BACK EDGE&quot;, &quot;FRONT EDGE BEAM&quot;};" ShouldFocus="false" />
    <PythonNodeModels.PythonNode guid="cd241a60-cd94-4861-82ed-d8778005764e" type="PythonNodeModels.PythonNode" nickname="Python Script" x="-3123.44546072836" y="-2229.38777374129" isVisible="true" isUpstreamVisible="true" lacing="Disabled" isSelectedInput="False" IsFrozen="false" isPinned="false" inputcount="4">
      <PortInfo index="0" default="False" />
      <PortInfo index="1" default="False" />
      <PortInfo index="2" default="False" />
      <PortInfo index="3" default="False" />
      <Script>#Copyright 2016. All rights reserved. Bimorph Consultancy LTD, 5 St Johns Lane, London EC1M 4BH www.bimorph.co.uk
#Written by Thomas Mahon @Thomas__Mahon info@bimorph.co.uk package: bimorphNodes
#GitHub: https://github.com/ThomasMahon/bimorphNodes/

import clr

# Import DocumentManager and TransactionManager
clr.AddReference("RevitServices")
import RevitServices
from RevitServices.Persistence import DocumentManager
from RevitServices.Transactions import TransactionManager
from System.Collections.Generic import *

clr.AddReference("RevitNodes")
import Revit
# Import ToProtoType, ToRevitType geometry conversion extension methods
clr.ImportExtensions(Revit.GeometryConversion)

# Import RevitAPI
clr.AddReference("RevitAPI")
import Autodesk
from Autodesk.Revit.DB import *

doc = DocumentManager.Instance.CurrentDBDocument
uiapp = DocumentManager.Instance.CurrentUIApplication
app = uiapp.Application

importDWG = UnwrapElement(IN[0])
nameOfLayersToImport = IN[1]
revitModelLines = IN[2]

if nameOfLayersToImport == None or nameOfLayersToImport == []: 
	catSub = importDWG.Category.SubCategories
	enum = catSub.GetEnumerator()
	
	nameOfLayersToImport = []
	while enum.MoveNext():
		layerName = enum.Current.Name
		nameOfLayersToImport.Add( layerName )

if isinstance(nameOfLayersToImport, list):
	layerList = nameOfLayersToImport
else:
	layerList = [nameOfLayersToImport]

def storageDictionary(crvListDict, eleGraphicStyleName, e):
	if eleGraphicStyleName in crvListDict.keys(): 
		crvListDict[eleGraphicStyleName].append( e )
	else:
		crvListDict[eleGraphicStyleName] = []
		crvListDict[eleGraphicStyleName].append( e )
		
	
def curveConversion (crv, revitModelLines, crvObject, refPlane):
	if revitModelLines == True:
		crv.Add( doc.Create.NewModelCurve( crvObject, refPlane) )
	else:
		crv.Add( crvObject.ToProtoType() )
	
TransactionManager.Instance.EnsureInTransaction(doc)

geomEnum = importDWG.Geometry[ Options() ].GetEnumerator()

crvListDict = dict()
failedFilter = []
while geomEnum.MoveNext(): 
	instGeom = geomEnum.Current.GetInstanceGeometry()
	
	instGeomEnum = instGeom.GetEnumerator()
	while instGeomEnum.MoveNext():
		e = instGeomEnum.Current
		try:
			graphicStyleId = e.GraphicsStyleId
					
			eleGraphicStyle = doc.GetElement(graphicStyleId)
			eleGraphicStyleName = eleGraphicStyle.GraphicsStyleCategory.Name
			
			
			if eleGraphicStyleName in layerList: 
				storageDictionary(crvListDict, eleGraphicStyleName, e)

		except:
			try: 
				vol = e.Volume
				
				if vol == 0.0: 
					edgesList = e.Edges
					edgesEnum = edgesList.GetEnumerator()

					while edgesEnum.MoveNext():
						edge = edgesEnum.Current
						eleGraphicStyle = doc.GetElement(edge.GraphicsStyleId)
						eleGraphicStyleName = eleGraphicStyle.GraphicsStyleCategory.Name
						
						if eleGraphicStyleName in layerList:
							storageDictionary(crvListDict, eleGraphicStyleName, edge.AsCurve() )
							
			except: 
				failedFilter.Add(e)

if "2015" in app.VersionName:
	levelParam = "Base Level"
else:
	levelParam = BuiltInParameter.IMPORT_BASE_LEVEL

levelId = UnwrapElement(IN[3]).Id

pln = SketchPlane.Create(doc, levelId )
	
crvList = [ crv for crv in crvListDict.values() ] 

failedConversion = []
modelLines =  []
for subList in crvList: 
	crv = []
	for i in subList: 
		try:
			crvType = i.GetType()
			if crvType != Autodesk.Revit.DB.PolyLine:
				curveConversion(crv, revitModelLines, i, pln)
			else: 
				pt = i.GetCoordinates()
				count = i.NumberOfCoordinates
					
				for j in range(count-1): 
					ln = Line.CreateBound(pt[j], pt[j+1])
					curveConversion(crv, revitModelLines, ln, pln)
						
		except: 
			failedConversion.Add( i )
				
	modelLines.Add(crv)

TransactionManager.Instance.TransactionTaskDone()

OUT = modelLines, crvListDict.keys()</Script>
    </PythonNodeModels.PythonNode>
    <CoreNodeModels.Input.BoolSelector guid="b7efa3d5-60d4-439c-9dff-3b4e692668a4" type="CoreNodeModels.Input.BoolSelector" nickname="Boolean" x="-3400.6589726879" y="-2035.40805239511" isVisible="true" isUpstreamVisible="true" lacing="Disabled" isSelectedInput="True" IsFrozen="false" isPinned="false">
      <System.Boolean>False</System.Boolean>
    </CoreNodeModels.Input.BoolSelector>
    <Dynamo.Graph.Nodes.CodeBlockNodeModel guid="612e3b4e-f300-4056-8c8b-e9c51741193d" type="Dynamo.Graph.Nodes.CodeBlockNodeModel" nickname="Code Block" x="-2732.58315732528" y="-2191.28965646473" isVisible="true" isUpstreamVisible="true" lacing="Disabled" isSelectedInput="False" IsFrozen="false" isPinned="false" CodeText="A[0];" ShouldFocus="false">
      <PortInfo index="0" default="False" />
    </Dynamo.Graph.Nodes.CodeBlockNodeModel>
    <Dynamo.Graph.Nodes.CodeBlockNodeModel guid="01a27906-e190-4767-9b46-efe17df6ea54" type="Dynamo.Graph.Nodes.CodeBlockNodeModel" nickname="Code Block" x="-2762.50156677932" y="-2005.40681445204" isVisible="true" isUpstreamVisible="true" lacing="Disabled" isSelectedInput="False" IsFrozen="false" isPinned="false" CodeText="A[1];" ShouldFocus="false">
      <PortInfo index="0" default="False" />
    </Dynamo.Graph.Nodes.CodeBlockNodeModel>
    <DSRevitNodesUI.Levels guid="6d5ff1a1-c095-4794-bb9b-1f0eb9291a47" type="DSRevitNodesUI.Levels" nickname="Levels" x="-4337.84534727596" y="-1926.1593505269" isVisible="true" isUpstreamVisible="true" lacing="Disabled" isSelectedInput="True" IsFrozen="false" isPinned="false" index="-1" />
    <Dynamo.Graph.Nodes.CodeBlockNodeModel guid="cad6b846-a861-4f8d-b19d-e51bbe9838a3" type="Dynamo.Graph.Nodes.CodeBlockNodeModel" nickname="Code Block" x="-2707.36699608103" y="-2341.11009189928" isVisible="true" isUpstreamVisible="true" lacing="Disabled" isSelectedInput="False" IsFrozen="false" isPinned="false" CodeText="Flatten(a[0]);" ShouldFocus="false">
      <PortInfo index="0" default="False" />
    </Dynamo.Graph.Nodes.CodeBlockNodeModel>
    <DSRevitNodesUI.StructuralFramingTypes guid="5c4069d6-a178-4ebd-80e0-9b8156ca94e8" type="DSRevitNodesUI.StructuralFramingTypes" nickname="Structural Framing Types" x="-2617.86217460692" y="-1936.99133599463" isVisible="true" isUpstreamVisible="true" lacing="Disabled" isSelectedInput="True" IsFrozen="false" isPinned="false" index="1155:UKC203x203x71" />
    <CoreNodeModels.CreateList guid="0fa2dd9c-f77f-4ba1-a1e2-75679ced6cc6" type="CoreNodeModels.CreateList" nickname="List.Create" x="-2357.80126210382" y="-2120.1732398195" isVisible="true" isUpstreamVisible="true" lacing="Disabled" isSelectedInput="False" IsFrozen="false" isPinned="false" inputcount="3">
      <PortInfo index="0" default="False" />
      <PortInfo index="1" default="False" />
      <PortInfo index="2" default="False" />
    </CoreNodeModels.CreateList>
    <Dynamo.Graph.Nodes.ZeroTouch.DSFunction guid="5cd98693-ac08-454a-8bbe-310b11883b2b" type="Dynamo.Graph.Nodes.ZeroTouch.DSFunction" nickname="StructuralFraming.BeamByCurve" x="-2331.28626875354" y="-2656.44358634947" isVisible="true" isUpstreamVisible="true" lacing="Longest" isSelectedInput="False" IsFrozen="false" isPinned="false" assembly="RevitNodes.dll" function="Revit.Elements.StructuralFraming.BeamByCurve@Autodesk.DesignScript.Geometry.Curve,Revit.Elements.Level,Revit.Elements.FamilyType">
      <PortInfo index="0" default="False" />
      <PortInfo index="1" default="False" />
      <PortInfo index="2" default="False" />
    </Dynamo.Graph.Nodes.ZeroTouch.DSFunction>
    <CoreNodeModels.CreateList guid="d845b323-a98a-4267-826e-ba34f96c087f" type="CoreNodeModels.CreateList" nickname="List.Create" x="-2249.17050950332" y="-1940.22151242992" isVisible="true" isUpstreamVisible="true" lacing="Disabled" isSelectedInput="False" IsFrozen="false" isPinned="false" inputcount="3">
      <PortInfo index="0" default="False" />
      <PortInfo index="1" default="False" />
      <PortInfo index="2" default="False" />
    </CoreNodeModels.CreateList>
    <CoreNodeModels.HigherOrder.Combine guid="f07c0f75-ca4f-44dc-abb7-f55c193d3a23" type="CoreNodeModels.HigherOrder.Combine" nickname="List.Combine" x="-2059.54170235274" y="-2213.73964708877" isVisible="true" isUpstreamVisible="true" lacing="Disabled" isSelectedInput="False" IsFrozen="false" isPinned="false" inputcount="4">
      <PortInfo index="0" default="False" />
      <PortInfo index="1" default="False" />
      <PortInfo index="2" default="False" />
      <PortInfo index="3" default="False" />
    </CoreNodeModels.HigherOrder.Combine>
    <DSRevitNodesUI.StructuralFramingTypes guid="3ac338b4-c661-449b-8d74-19a46ea6975c" type="DSRevitNodesUI.StructuralFramingTypes" nickname="Structural Framing Types" x="-2615.89749003101" y="-1845.33393649606" isVisible="true" isUpstreamVisible="true" lacing="Disabled" isSelectedInput="True" IsFrozen="false" isPinned="false" index="1155:UKC203x203x71" />
    <Dynamo.Graph.Nodes.ZeroTouch.DSFunction guid="f8fe44d5-7f4b-4613-aa88-bffb614a77c8" type="Dynamo.Graph.Nodes.ZeroTouch.DSFunction" nickname="Count" x="-1839.09556463018" y="-2200.98271580122" isVisible="true" isUpstreamVisible="true" lacing="Longest" isSelectedInput="False" IsFrozen="false" isPinned="false" assembly="BuiltIn" function="Count@var[]..[]">
      <PortInfo index="0" default="False" />
    </Dynamo.Graph.Nodes.ZeroTouch.DSFunction>
    <DSRevitNodesUI.StructuralFramingTypes guid="0510af6b-cd8e-40ad-91e8-c8f9fd9cb3a6" type="DSRevitNodesUI.StructuralFramingTypes" nickname="Structural Framing Types" x="-2612.54977845694" y="-1752.84556001457" isVisible="true" isUpstreamVisible="true" lacing="Disabled" isSelectedInput="True" IsFrozen="false" isPinned="false" index="1155:UKC203x203x71" />
    <Dynamo.Graph.Nodes.ZeroTouch.DSFunction guid="211fe016-3a11-4bfc-874a-38adf2255b1d" type="Dynamo.Graph.Nodes.ZeroTouch.DSFunction" nickname="List.Cycle" x="-1675.80422643314" y="-2045.17037019335" isVisible="true" isUpstreamVisible="true" lacing="Longest" isSelectedInput="False" IsFrozen="false" isPinned="false" assembly="DSCoreNodes.dll" function="DSCore.List.Cycle@var[]..[],int">
      <PortInfo index="0" default="False" />
      <PortInfo index="1" default="False" />
    </Dynamo.Graph.Nodes.ZeroTouch.DSFunction>
    <Dynamo.Graph.Nodes.CodeBlockNodeModel guid="081cc3ed-b4c4-40eb-88d1-8e3fe8e9aa1d" type="Dynamo.Graph.Nodes.CodeBlockNodeModel" nickname="Code Block" x="-1614.65600663856" y="-2261.17767599642" isVisible="true" isUpstreamVisible="true" lacing="Disabled" isSelectedInput="False" IsFrozen="false" isPinned="false" CodeText="Flatten(a);" ShouldFocus="false">
      <PortInfo index="0" default="False" />
    </Dynamo.Graph.Nodes.CodeBlockNodeModel>
    <Dynamo.Graph.Nodes.CodeBlockNodeModel guid="f9af6d0a-ebba-4653-8020-8f7dc2507c66" type="Dynamo.Graph.Nodes.CodeBlockNodeModel" nickname="Code Block" x="-1395.798878517" y="-2201.60326012414" isVisible="true" isUpstreamVisible="true" lacing="Disabled" isSelectedInput="False" IsFrozen="false" isPinned="false" CodeText="Flatten(a);" ShouldFocus="false">
      <PortInfo index="0" default="False" />
    </Dynamo.Graph.Nodes.CodeBlockNodeModel>
    <Dynamo.Graph.Nodes.CodeBlockNodeModel guid="57bd56f8-b447-4e8b-8241-9927cfd1f09c" type="Dynamo.Graph.Nodes.CodeBlockNodeModel" nickname="Code Block" x="-1411.55688411066" y="-2478.75044292288" isVisible="true" isUpstreamVisible="true" lacing="Disabled" isSelectedInput="False" IsFrozen="false" isPinned="false" CodeText="&quot;Comments&quot;;" ShouldFocus="false" />
    <Dynamo.Graph.Nodes.ZeroTouch.DSFunction guid="8bd8dcce-d217-413a-8453-efc514332090" type="Dynamo.Graph.Nodes.ZeroTouch.DSFunction" nickname="Element.SetParameterByName" x="-1184.26292994616" y="-2509.89399710616" isVisible="true" isUpstreamVisible="true" lacing="Shortest" isSelectedInput="False" IsFrozen="false" isPinned="false" assembly="RevitNodes.dll" function="Revit.Elements.Element.SetParameterByName@string,var">
      <PortInfo index="0" default="False" />
      <PortInfo index="1" default="False" />
      <PortInfo index="2" default="False" />
    </Dynamo.Graph.Nodes.ZeroTouch.DSFunction>
    <Dynamo.Graph.Nodes.CustomNodes.Function guid="6deaa3c9-6e95-4e2c-985e-b195aebe9cd3" type="Dynamo.Graph.Nodes.CustomNodes.Function" nickname="CurvesFromCADLayers" x="-3194.30288498725" y="-1085.70727646428" isVisible="true" isUpstreamVisible="true" lacing="Shortest" isSelectedInput="False" IsFrozen="false" isPinned="false">
      <PortInfo index="0" default="False" />
      <PortInfo index="1" default="True" />
      <PortInfo index="2" default="True" />
      <ID value="0eeb8f98-a56a-4c60-af50-994a0f209a37" />
      <Name value="CurvesFromCADLayers" />
      <Description value="Extract curves from a CAD link or import by layer name. Curves are organised into layer sublists. To create Revit Model Lines set the createModelLines input to true&#xD;&#xA;&#xD;&#xA;This node is also optimised to convert curve types that typically fail when using Revit.Elements.Element.Curves or Full Explode" />
      <Inputs>
        <Input value="importInstance" />
        <Input value="layerNames" />
        <Input value="createModelLines" />
      </Inputs>
      <Outputs>
        <Output value="curves" />
        <Output value="layerKeys" />
      </Outputs>
    </Dynamo.Graph.Nodes.CustomNodes.Function>
  </Elements>
  <Connectors>
    <Dynamo.Graph.Connectors.ConnectorModel start="0509eed7-e5b9-43a9-aaf4-53d8da7ee443" start_index="0" end="c880adb7-3613-4b3b-92a9-67177d6133e8" end_index="0" portType="0" />
    <Dynamo.Graph.Connectors.ConnectorModel start="0509eed7-e5b9-43a9-aaf4-53d8da7ee443" start_index="0" end="82ae8341-4028-4330-91cf-58a2361cd83b" end_index="0" portType="0" />
    <Dynamo.Graph.Connectors.ConnectorModel start="1c522a25-6af4-46aa-b350-60727ce727a5" start_index="0" end="c869b1e4-5c3c-4d8d-8a31-6ba8b1e9e916" end_index="0" portType="0" />
    <Dynamo.Graph.Connectors.ConnectorModel start="789a48f6-aa1d-42e8-b96e-4e1887c6125d" start_index="0" end="82ae8341-4028-4330-91cf-58a2361cd83b" end_index="2" portType="0" />
    <Dynamo.Graph.Connectors.ConnectorModel start="82ae8341-4028-4330-91cf-58a2361cd83b" start_index="0" end="8a2817fd-301b-40ab-9d2e-f35a92bbfb85" end_index="0" portType="0" />
    <Dynamo.Graph.Connectors.ConnectorModel start="82ae8341-4028-4330-91cf-58a2361cd83b" start_index="0" end="536f008a-5b32-41f9-9f5c-a9c2bc37b7b9" end_index="0" portType="0" />
    <Dynamo.Graph.Connectors.ConnectorModel start="82ae8341-4028-4330-91cf-58a2361cd83b" start_index="0" end="ddcd6f9f-6e25-40a4-b8aa-031cd1a49bbc" end_index="0" portType="0" />
    <Dynamo.Graph.Connectors.ConnectorModel start="7478bc31-c70e-4d79-ac7f-9a6d7c30c98f" start_index="0" end="82ae8341-4028-4330-91cf-58a2361cd83b" end_index="3" portType="0" />
    <Dynamo.Graph.Connectors.ConnectorModel start="7478bc31-c70e-4d79-ac7f-9a6d7c30c98f" start_index="0" end="c869b1e4-5c3c-4d8d-8a31-6ba8b1e9e916" end_index="2" portType="0" />
    <Dynamo.Graph.Connectors.ConnectorModel start="18de7573-ca20-46ca-8b51-c6a2f4e3c68a" start_index="0" end="2055fd68-2ee3-491a-96d0-23d9a6e001d7" end_index="0" portType="0" />
    <Dynamo.Graph.Connectors.ConnectorModel start="18de7573-ca20-46ca-8b51-c6a2f4e3c68a" start_index="0" end="8df92d03-7b04-4e9e-ba43-2a3b6663d227" end_index="0" portType="0" />
    <Dynamo.Graph.Connectors.ConnectorModel start="6d4e7ada-0520-4b82-94f5-1aa76132d53a" start_index="0" end="8df92d03-7b04-4e9e-ba43-2a3b6663d227" end_index="1" portType="0" />
    <Dynamo.Graph.Connectors.ConnectorModel start="33713f69-9823-4171-beb6-5861f0d8f442" start_index="0" end="6d4e7ada-0520-4b82-94f5-1aa76132d53a" end_index="1" portType="0" />
    <Dynamo.Graph.Connectors.ConnectorModel start="ad82c5f5-5d85-495c-bf5b-6ebcb6d6e061" start_index="0" end="6d4e7ada-0520-4b82-94f5-1aa76132d53a" end_index="2" portType="0" />
    <Dynamo.Graph.Connectors.ConnectorModel start="2055fd68-2ee3-491a-96d0-23d9a6e001d7" start_index="0" end="e9a48d91-ace3-4dbf-b8bf-25d393245e76" end_index="0" portType="0" />
    <Dynamo.Graph.Connectors.ConnectorModel start="8df92d03-7b04-4e9e-ba43-2a3b6663d227" start_index="0" end="c869b1e4-5c3c-4d8d-8a31-6ba8b1e9e916" end_index="3" portType="0" />
    <Dynamo.Graph.Connectors.ConnectorModel start="e9a48d91-ace3-4dbf-b8bf-25d393245e76" start_index="0" end="6d4e7ada-0520-4b82-94f5-1aa76132d53a" end_index="0" portType="0" />
    <Dynamo.Graph.Connectors.ConnectorModel start="fac5a40a-77b2-4de4-af8c-7a082d6891c2" start_index="0" end="c880adb7-3613-4b3b-92a9-67177d6133e8" end_index="1" portType="0" />
    <Dynamo.Graph.Connectors.ConnectorModel start="d20b35ce-6759-44bf-8ade-c2623522ae44" start_index="0" end="6a380aca-da6f-437d-82fc-158ac34ba5e6" end_index="1" portType="0" />
    <Dynamo.Graph.Connectors.ConnectorModel start="d20b35ce-6759-44bf-8ade-c2623522ae44" start_index="0" end="c880adb7-3613-4b3b-92a9-67177d6133e8" end_index="3" portType="0" />
    <Dynamo.Graph.Connectors.ConnectorModel start="72b61969-6842-4421-a30d-1ca0678bde5f" start_index="0" end="6a380aca-da6f-437d-82fc-158ac34ba5e6" end_index="2" portType="0" />
    <Dynamo.Graph.Connectors.ConnectorModel start="47ba6003-24aa-4123-a5a0-6e6c1afdea18" start_index="0" end="c880adb7-3613-4b3b-92a9-67177d6133e8" end_index="2" portType="0" />
    <Dynamo.Graph.Connectors.ConnectorModel start="55c8668b-cf50-4a8f-9193-863ac422c7b3" start_index="0" end="6a380aca-da6f-437d-82fc-158ac34ba5e6" end_index="0" portType="0" />
    <Dynamo.Graph.Connectors.ConnectorModel start="ec19179a-c78b-42b2-b0f0-3f37a39b17ec" start_index="0" end="403e05b7-f4f4-4207-8a31-f9af67ced0de" end_index="1" portType="0" />
    <Dynamo.Graph.Connectors.ConnectorModel start="f85f7ade-73f2-4b05-b46c-a34b8b7155b0" start_index="0" end="82ae8341-4028-4330-91cf-58a2361cd83b" end_index="1" portType="0" />
    <Dynamo.Graph.Connectors.ConnectorModel start="536f008a-5b32-41f9-9f5c-a9c2bc37b7b9" start_index="0" end="c869b1e4-5c3c-4d8d-8a31-6ba8b1e9e916" end_index="1" portType="0" />
    <Dynamo.Graph.Connectors.ConnectorModel start="ddcd6f9f-6e25-40a4-b8aa-031cd1a49bbc" start_index="0" end="9b71543b-0a7f-4f0e-87cc-cf63a5134c9d" end_index="0" portType="0" />
    <Dynamo.Graph.Connectors.ConnectorModel start="c869b1e4-5c3c-4d8d-8a31-6ba8b1e9e916" start_index="0" end="a2319839-617a-49ae-a885-879f136ba155" end_index="0" portType="0" />
    <Dynamo.Graph.Connectors.ConnectorModel start="c869b1e4-5c3c-4d8d-8a31-6ba8b1e9e916" start_index="0" end="25d6fc9d-8286-4a39-b7d4-aa62647cc5f2" end_index="0" portType="0" />
    <Dynamo.Graph.Connectors.ConnectorModel start="9b71543b-0a7f-4f0e-87cc-cf63a5134c9d" start_index="0" end="b3a6a577-28e6-4a60-a58d-8d9f7cc28d0f" end_index="0" portType="0" />
    <Dynamo.Graph.Connectors.ConnectorModel start="a2319839-617a-49ae-a885-879f136ba155" start_index="0" end="9b71543b-0a7f-4f0e-87cc-cf63a5134c9d" end_index="1" portType="0" />
    <Dynamo.Graph.Connectors.ConnectorModel start="25d6fc9d-8286-4a39-b7d4-aa62647cc5f2" start_index="0" end="403e05b7-f4f4-4207-8a31-f9af67ced0de" end_index="0" portType="0" />
    <Dynamo.Graph.Connectors.ConnectorModel start="b3a6a577-28e6-4a60-a58d-8d9f7cc28d0f" start_index="0" end="403e05b7-f4f4-4207-8a31-f9af67ced0de" end_index="2" portType="0" />
    <Dynamo.Graph.Connectors.ConnectorModel start="d8e468a5-e110-44f9-b1ec-96cbb8d84961" start_index="0" end="cd241a60-cd94-4861-82ed-d8778005764e" end_index="1" portType="0" />
    <Dynamo.Graph.Connectors.ConnectorModel start="cd241a60-cd94-4861-82ed-d8778005764e" start_index="0" end="cad6b846-a861-4f8d-b19d-e51bbe9838a3" end_index="0" portType="0" />
    <Dynamo.Graph.Connectors.ConnectorModel start="cd241a60-cd94-4861-82ed-d8778005764e" start_index="0" end="612e3b4e-f300-4056-8c8b-e9c51741193d" end_index="0" portType="0" />
    <Dynamo.Graph.Connectors.ConnectorModel start="cd241a60-cd94-4861-82ed-d8778005764e" start_index="0" end="01a27906-e190-4767-9b46-efe17df6ea54" end_index="0" portType="0" />
    <Dynamo.Graph.Connectors.ConnectorModel start="b7efa3d5-60d4-439c-9dff-3b4e692668a4" start_index="0" end="cd241a60-cd94-4861-82ed-d8778005764e" end_index="2" portType="0" />
    <Dynamo.Graph.Connectors.ConnectorModel start="612e3b4e-f300-4056-8c8b-e9c51741193d" start_index="0" end="f07c0f75-ca4f-44dc-abb7-f55c193d3a23" end_index="1" portType="0" />
    <Dynamo.Graph.Connectors.ConnectorModel start="01a27906-e190-4767-9b46-efe17df6ea54" start_index="0" end="211fe016-3a11-4bfc-874a-38adf2255b1d" end_index="0" portType="0" />
    <Dynamo.Graph.Connectors.ConnectorModel start="6d5ff1a1-c095-4794-bb9b-1f0eb9291a47" start_index="0" end="cd241a60-cd94-4861-82ed-d8778005764e" end_index="3" portType="0" />
    <Dynamo.Graph.Connectors.ConnectorModel start="6d5ff1a1-c095-4794-bb9b-1f0eb9291a47" start_index="0" end="0fa2dd9c-f77f-4ba1-a1e2-75679ced6cc6" end_index="0" portType="0" />
    <Dynamo.Graph.Connectors.ConnectorModel start="6d5ff1a1-c095-4794-bb9b-1f0eb9291a47" start_index="0" end="0fa2dd9c-f77f-4ba1-a1e2-75679ced6cc6" end_index="1" portType="0" />
    <Dynamo.Graph.Connectors.ConnectorModel start="6d5ff1a1-c095-4794-bb9b-1f0eb9291a47" start_index="0" end="0fa2dd9c-f77f-4ba1-a1e2-75679ced6cc6" end_index="2" portType="0" />
    <Dynamo.Graph.Connectors.ConnectorModel start="5c4069d6-a178-4ebd-80e0-9b8156ca94e8" start_index="0" end="d845b323-a98a-4267-826e-ba34f96c087f" end_index="0" portType="0" />
    <Dynamo.Graph.Connectors.ConnectorModel start="0fa2dd9c-f77f-4ba1-a1e2-75679ced6cc6" start_index="0" end="f07c0f75-ca4f-44dc-abb7-f55c193d3a23" end_index="2" portType="0" />
    <Dynamo.Graph.Connectors.ConnectorModel start="5cd98693-ac08-454a-8bbe-310b11883b2b" start_index="0" end="f07c0f75-ca4f-44dc-abb7-f55c193d3a23" end_index="0" portType="0" />
    <Dynamo.Graph.Connectors.ConnectorModel start="d845b323-a98a-4267-826e-ba34f96c087f" start_index="0" end="f07c0f75-ca4f-44dc-abb7-f55c193d3a23" end_index="3" portType="0" />
    <Dynamo.Graph.Connectors.ConnectorModel start="f07c0f75-ca4f-44dc-abb7-f55c193d3a23" start_index="0" end="f8fe44d5-7f4b-4613-aa88-bffb614a77c8" end_index="0" portType="0" />
    <Dynamo.Graph.Connectors.ConnectorModel start="f07c0f75-ca4f-44dc-abb7-f55c193d3a23" start_index="0" end="081cc3ed-b4c4-40eb-88d1-8e3fe8e9aa1d" end_index="0" portType="0" />
    <Dynamo.Graph.Connectors.ConnectorModel start="3ac338b4-c661-449b-8d74-19a46ea6975c" start_index="0" end="d845b323-a98a-4267-826e-ba34f96c087f" end_index="1" portType="0" />
    <Dynamo.Graph.Connectors.ConnectorModel start="f8fe44d5-7f4b-4613-aa88-bffb614a77c8" start_index="0" end="211fe016-3a11-4bfc-874a-38adf2255b1d" end_index="1" portType="0" />
    <Dynamo.Graph.Connectors.ConnectorModel start="0510af6b-cd8e-40ad-91e8-c8f9fd9cb3a6" start_index="0" end="d845b323-a98a-4267-826e-ba34f96c087f" end_index="2" portType="0" />
    <Dynamo.Graph.Connectors.ConnectorModel start="211fe016-3a11-4bfc-874a-38adf2255b1d" start_index="0" end="f9af6d0a-ebba-4653-8020-8f7dc2507c66" end_index="0" portType="0" />
    <Dynamo.Graph.Connectors.ConnectorModel start="081cc3ed-b4c4-40eb-88d1-8e3fe8e9aa1d" start_index="0" end="8bd8dcce-d217-413a-8453-efc514332090" end_index="0" portType="0" />
    <Dynamo.Graph.Connectors.ConnectorModel start="f9af6d0a-ebba-4653-8020-8f7dc2507c66" start_index="0" end="8bd8dcce-d217-413a-8453-efc514332090" end_index="2" portType="0" />
    <Dynamo.Graph.Connectors.ConnectorModel start="57bd56f8-b447-4e8b-8241-9927cfd1f09c" start_index="0" end="8bd8dcce-d217-413a-8453-efc514332090" end_index="1" portType="0" />
  </Connectors>
  <Notes>
    <Dynamo.Graph.Notes.NoteModel guid="b3076939-e8b1-4d67-83ba-d8e884991f57" text=" " x="-4007.69407219007" y="-839.997792759506" />
    <Dynamo.Graph.Notes.NoteModel guid="ccfd37d5-de67-4636-9376-2cfe6ce12f4f" text=" " x="-3623.30386318223" y="284.631858492385" />
    <Dynamo.Graph.Notes.NoteModel guid="e4b712d8-749a-4c94-a11a-8a74ae602d09" text=" " x="-2968.09514337569" y="-716.547218287581" />
    <Dynamo.Graph.Notes.NoteModel guid="8d731e50-3913-4a9a-9a13-ff0b0ab80254" text=" " x="-3454.66095602096" y="-2290.14922565402" />
    <Dynamo.Graph.Notes.NoteModel guid="cb566774-8d68-4592-81e0-3a1e87999e06" text=" " x="-2884.47762629286" y="-2108.19475715114" />
    <Dynamo.Graph.Notes.NoteModel guid="e3d08304-b940-40d2-86f6-810a01a3eafc" text="Collect all the beams in Revit" x="-3800.04551625993" y="-321.639860048584" />
    <Dynamo.Graph.Notes.NoteModel guid="a38b8877-bf58-4355-ae35-cac4fbc257ae" text="New Note" x="-3134.76163638023" y="-2861.32975434396" />
    <Dynamo.Graph.Notes.NoteModel guid="9274b796-754a-4d0a-a2c5-ec87d00d23a5" text="New Note" x="-1698.49616528042" y="-2861.0033810268" />
    <Dynamo.Graph.Notes.NoteModel guid="4a46a75f-aec3-407f-8106-6ddb5d2bce60" text="New Note" x="-3223.62162182648" y="-1215.49084181192" />
    <Dynamo.Graph.Notes.NoteModel guid="e896ebe0-91f9-43dd-b1c6-616932107699" text="New Note" x="-1787.35615072667" y="-1215.16446849477" />
  </Notes>
  <Annotations>
    <Dynamo.Graph.Annotations.AnnotationModel guid="896d81bb-4ff0-4cdd-a6b4-d9b55f516f5c" annotationText="SELECT IMPORTED DWG" left="-4220.99057598166" top="-983.898581036016" width="273.296503791587" height="213" fontSize="36" InitialTop="-887.898581036016" InitialHeight="124" TextblockHeight="86" backgrouund="#FFD4B6DB">
      <Models ModelGuid="0509eed7-e5b9-43a9-aaf4-53d8da7ee443" />
      <Models ModelGuid="b3076939-e8b1-4d67-83ba-d8e884991f57" />
    </Dynamo.Graph.Annotations.AnnotationModel>
    <Dynamo.Graph.Annotations.AnnotationModel guid="fae2a2da-c7d8-450f-959f-6a7f30554cb4" annotationText="FROM biMORPH PACKAGE" left="-3850.99860893941" top="72.3478413225255" width="287.694745757184" height="256.28401716986" fontSize="36" InitialTop="168.347841322525" InitialHeight="201" TextblockHeight="86" backgrouund="#FFD8D8D8">
      <Models ModelGuid="c880adb7-3613-4b3b-92a9-67177d6133e8" />
      <Models ModelGuid="ccfd37d5-de67-4636-9376-2cfe6ce12f4f" />
    </Dynamo.Graph.Annotations.AnnotationModel>
    <Dynamo.Graph.Annotations.AnnotationModel guid="1f9020e0-188c-4165-9459-7dd0352c1511" annotationText="SELECT LAYER" left="-4431.46286435879" top="105.537915917766" width="123.643333333333" height="189" fontSize="36" InitialTop="201.537915917766" InitialHeight="123" TextblockHeight="86" backgrouund="#FFD4B6DB">
      <Models ModelGuid="fac5a40a-77b2-4de4-af8c-7a082d6891c2" />
    </Dynamo.Graph.Annotations.AnnotationModel>
    <Dynamo.Graph.Annotations.AnnotationModel guid="0f10f4c4-8c4a-4da4-97b3-8bbd10cf64b8" annotationText="SELECT COLUMN TYPE" left="-4431.46286435879" top="640.903697277015" width="213" height="233" fontSize="36" InitialTop="780.903697277015" InitialHeight="123" TextblockHeight="130" backgrouund="#FFD4B6DB">
      <Models ModelGuid="72b61969-6842-4421-a30d-1ca0678bde5f" />
    </Dynamo.Graph.Annotations.AnnotationModel>
    <Dynamo.Graph.Annotations.AnnotationModel guid="4384ffa9-6116-4d7c-8cb1-b03264adf170" annotationText="SELECT LEVEL" left="-4431.46286435879" top="385.963685581195" width="167" height="189" fontSize="36" InitialTop="481.963685581195" InitialHeight="123" TextblockHeight="86" backgrouund="#FFD4B6DB">
      <Models ModelGuid="d20b35ce-6759-44bf-8ade-c2623522ae44" />
    </Dynamo.Graph.Annotations.AnnotationModel>
    <Dynamo.Graph.Annotations.AnnotationModel guid="93690a18-18f4-4e84-a134-caa48fe5cf6b" annotationText="PLACE COLUMNS" left="-3445.25330121625" top="253.718462452365" width="597.324132268939" height="233.87778470358" fontSize="36" InitialTop="306.718462452365" InitialHeight="210.877784703577" TextblockHeight="43" backgrouund="#FFFFC999">
      <Models ModelGuid="6a380aca-da6f-437d-82fc-158ac34ba5e6" />
      <Models ModelGuid="55c8668b-cf50-4a8f-9193-863ac422c7b3" />
    </Dynamo.Graph.Annotations.AnnotationModel>
    <Dynamo.Graph.Annotations.AnnotationModel guid="2e630b93-1457-4e18-880d-ae94f88fa0ae" annotationText="TYPE BEAM SIZE" left="-4431.46286435879" top="-408.945782025638" width="140" height="208" fontSize="36" InitialTop="-268.945782025638" InitialHeight="98" TextblockHeight="130" backgrouund="#FFD4B6DB">
      <Models ModelGuid="33713f69-9823-4171-beb6-5861f0d8f442" />
    </Dynamo.Graph.Annotations.AnnotationModel>
    <Dynamo.Graph.Annotations.AnnotationModel guid="b00cb10e-e4e6-407d-ae9f-cf45eebb3952" annotationText="RETRIEVE THE SELECTED BEAM " left="-3810.04551625993" top="-374.639860048584" width="1468.12585933821" height="311.917552986777" fontSize="36" InitialTop="-321.639860048584" InitialHeight="293.466404678778" TextblockHeight="43" backgrouund="#FFD8D8D8">
      <Models ModelGuid="18de7573-ca20-46ca-8b51-c6a2f4e3c68a" />
      <Models ModelGuid="6d4e7ada-0520-4b82-94f5-1aa76132d53a" />
      <Models ModelGuid="ad82c5f5-5d85-495c-bf5b-6ebcb6d6e061" />
      <Models ModelGuid="2055fd68-2ee3-491a-96d0-23d9a6e001d7" />
      <Models ModelGuid="8df92d03-7b04-4e9e-ba43-2a3b6663d227" />
      <Models ModelGuid="e9a48d91-ace3-4dbf-b8bf-25d393245e76" />
      <Models ModelGuid="e3d08304-b940-40d2-86f6-810a01a3eafc" />
    </Dynamo.Graph.Annotations.AnnotationModel>
    <Dynamo.Graph.Annotations.AnnotationModel guid="01505e4d-4e87-42f7-8451-18aedc9177cc" annotationText="SELECT LEVEL" left="-4431.46286435879" top="-630.511811663343" width="167" height="189" fontSize="36" InitialTop="-534.511811663343" InitialHeight="123" TextblockHeight="86" backgrouund="#FFD4B6DB">
      <Models ModelGuid="7478bc31-c70e-4d79-ac7f-9a6d7c30c98f" />
    </Dynamo.Graph.Annotations.AnnotationModel>
    <Dynamo.Graph.Annotations.AnnotationModel guid="43ed501d-20b2-4bc8-95d8-3230881baba3" annotationText="PLACE BEAMS" left="-2507.71586016833" top="-992.917909722104" width="1425.02333880739" height="344.549589243311" fontSize="36" InitialTop="-939.917909722104" InitialHeight="346.107280820817" TextblockHeight="43" backgrouund="#FFFFC999">
      <Models ModelGuid="1c522a25-6af4-46aa-b350-60727ce727a5" />
      <Models ModelGuid="403e05b7-f4f4-4207-8a31-f9af67ced0de" />
      <Models ModelGuid="ec19179a-c78b-42b2-b0f0-3f37a39b17ec" />
    </Dynamo.Graph.Annotations.AnnotationModel>
    <Dynamo.Graph.Annotations.AnnotationModel guid="98347488-b935-4c1f-93a2-2a5f12b729f7" annotationText="FROM biMORPH PACKAGE" left="-3217.06297781119" top="-933.740234877733" width="308.9678344355" height="261.193016590151" fontSize="36" InitialTop="-837.740234877733" InitialHeight="201" TextblockHeight="86" backgrouund="#FFD8D8D8">
      <Models ModelGuid="82ae8341-4028-4330-91cf-58a2361cd83b" />
      <Models ModelGuid="e4b712d8-749a-4c94-a11a-8a74ae602d09" />
    </Dynamo.Graph.Annotations.AnnotationModel>
    <Dynamo.Graph.Annotations.AnnotationModel guid="d1725056-7182-46e8-842e-e6caf51f31f0" annotationText="SELECT IMPORTED DWG" left="-3667.95745981254" top="-2434.05001393054" width="273.29650379158" height="213" fontSize="36" InitialTop="-2338.05001393054" InitialHeight="187.900788276514" TextblockHeight="86" backgrouund="#FFD4B6DB">
      <Models ModelGuid="c4325597-0277-4b48-bd8d-12f539a718bb" />
      <Models ModelGuid="8d731e50-3913-4a9a-9a13-ff0b0ab80254" />
    </Dynamo.Graph.Annotations.AnnotationModel>
    <Dynamo.Graph.Annotations.AnnotationModel guid="c7332b3c-04a3-49fc-be53-7d53c6e22d9a" annotationText="FROM biMORPH PACKAGE" left="-3133.44546072836" top="-2325.38777374129" width="308.9678344355" height="261.19301659015" fontSize="36" InitialTop="-2229.38777374129" InitialHeight="261.193016590149" TextblockHeight="86" backgrouund="#FFD8D8D8">
      <Models ModelGuid="cd241a60-cd94-4861-82ed-d8778005764e" />
      <Models ModelGuid="cb566774-8d68-4592-81e0-3a1e87999e06" />
    </Dynamo.Graph.Annotations.AnnotationModel>
    <Dynamo.Graph.Annotations.AnnotationModel guid="125239bf-05b8-47d0-a13c-69899365a3a3" annotationText="SELECT LEVEL" left="-4347.84534727596" top="-2022.1593505269" width="167" height="189" fontSize="36" InitialTop="-1926.1593505269" InitialHeight="123" TextblockHeight="86" backgrouund="#FFD4B6DB">
      <Models ModelGuid="6d5ff1a1-c095-4794-bb9b-1f0eb9291a47" />
    </Dynamo.Graph.Annotations.AnnotationModel>
    <Dynamo.Graph.Annotations.AnnotationModel guid="c96a74d0-61b0-422e-8e9d-f108a71c208c" annotationText="PLACE BEAMS" left="-2341.28626875354" top="-2709.44358634947" width="1425.02333880738" height="344.54958924331" fontSize="36" InitialTop="-2656.44358634947" InitialHeight="321.54958924331" TextblockHeight="43" backgrouund="#FFFFC999">
      <Models ModelGuid="5cd98693-ac08-454a-8bbe-310b11883b2b" />
      <Models ModelGuid="8bd8dcce-d217-413a-8453-efc514332090" />
      <Models ModelGuid="57bd56f8-b447-4e8b-8241-9927cfd1f09c" />
    </Dynamo.Graph.Annotations.AnnotationModel>
    <Dynamo.Graph.Annotations.AnnotationModel guid="c01881bb-501b-4ba4-970a-13e115781a42" annotationText="IN THIS GRAPH YOU FEED A LIST OF STRUCTURAL FRAMING TYPES" left="-3144.76163638023" top="-2929.32975434396" width="1530.26547109981" height="112.326373317153" fontSize="48" InitialTop="-2861.32975434396" InitialHeight="74" TextblockHeight="58" backgrouund="#FFC1D676">
      <Models ModelGuid="a38b8877-bf58-4355-ae35-cac4fbc257ae" />
      <Models ModelGuid="9274b796-754a-4d0a-a2c5-ec87d00d23a5" />
    </Dynamo.Graph.Annotations.AnnotationModel>
    <Dynamo.Graph.Annotations.AnnotationModel guid="294ed505-a174-4bfb-886b-3ca8b3d9e55f" annotationText="IN THIS GRAPH YOU TYPE THE BEAM NAME AND THE PYTHON SCRIPT SELECTS THAT BEAM TYPE FROM ALL THE BEAM IN THE PROJECT" left="-3233.62162182648" top="-1340.49084181192" width="1530.26547109981" height="169.326373317153" fontSize="48" InitialTop="-1215.49084181192" InitialHeight="140.326373317153" TextblockHeight="115" backgrouund="#FFC1D676">
      <Models ModelGuid="4a46a75f-aec3-407f-8106-6ddb5d2bce60" />
      <Models ModelGuid="e896ebe0-91f9-43dd-b1c6-616932107699" />
    </Dynamo.Graph.Annotations.AnnotationModel>
  </Annotations>
  <Presets />
  <Cameras>
    <Camera Name="Background Preview" eyeX="-17" eyeY="24" eyeZ="50" lookX="12" lookY="-13" lookZ="-58" upX="0" upY="1" upZ="0" />
  </Cameras>
</Workspace>